{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/akash/PROJECTS/metaverse-lab-main/metaverse-lab-main/lib/firebase.ts"],"sourcesContent":["import { initializeApp, getApps, getApp } from \"firebase/app\";\nimport { getAuth, GoogleAuthProvider } from \"firebase/auth\"; // Added GoogleAuthProvider import\nimport { getDatabase } from \"firebase/database\";\nimport { getAnalytics, isSupported } from \"firebase/analytics\";\n\nconst firebaseConfig = {\n  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,\n  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,\n  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\n  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\n  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,\n  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,\n  measurementId: process.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID,\n  databaseURL:process.env.NEXT_PUBLIC_DATABASE_URL\n};\n\n// Initialize Firebase (Singleton pattern)\nconst app = !getApps().length ? initializeApp(firebaseConfig) : getApp();\n\n// Initialize Services\nconst auth = getAuth(app);\nconst db = getDatabase(app);\nconst googleProvider = new GoogleAuthProvider(); \n\n// CONFIGURING THE PROVIDER WITH SCOPES\n\n// 1. CLASSROOM PERMISSIONS\ngoogleProvider.addScope('https://www.googleapis.com/auth/classroom.courses'); // Read/Write courses\ngoogleProvider.addScope('https://www.googleapis.com/auth/classroom.coursework.students'); // Student work\ngoogleProvider.addScope('https://www.googleapis.com/auth/classroom.rosters.readonly'); // View students\n\n// 2. CALENDAR PERMISSIONS\ngoogleProvider.addScope('https://www.googleapis.com/auth/calendar.events'); \n\n// 3. SHEETS/DRIVE PERMISSIONS\ngoogleProvider.addScope('https://www.googleapis.com/auth/spreadsheets');\ngoogleProvider.addScope('https://www.googleapis.com/auth/drive.file');\n\n\n// 4. FORCE CONSENT PROMPT (Crucial for testing!)\n// This forces Google to show the \"Allow NetVerse to access...\" screen again\ngoogleProvider.setCustomParameters({\n  prompt: 'select_account consent'\n});\n\n// Initialize Analytics (Client-side only)\nlet analytics;\nif (typeof window !== \"undefined\") {\n  isSupported().then((supported) => {\n    if (supported) {\n      analytics = getAnalytics(app);\n    }\n  });\n}\n\n// Export everything, including googleProvider\nexport { app, auth, db, googleProvider, analytics };"],"names":[],"mappings":";;;;;;;;;;;;AAMU;AANV;AAAA;AACA,saAA6D,kCAAkC;AAA/F;AACA;AAAA;AACA;AAAA;;;;;AAEA,MAAM,iBAAiB;IACrB,MAAM;IACN,UAAU;IACV,SAAS;IACT,aAAa;IACb,iBAAiB;IACjB,KAAK;IACL,aAAa;IACb,WAAW;AACb;AAEA,0CAA0C;AAC1C,MAAM,MAAM,CAAC,IAAA,kPAAO,IAAG,MAAM,GAAG,IAAA,wPAAa,EAAC,kBAAkB,IAAA,iPAAM;AAEtE,sBAAsB;AACtB,MAAM,OAAO,IAAA,4OAAO,EAAC;AACrB,MAAM,KAAK,IAAA,oPAAW,EAAC;AACvB,MAAM,iBAAiB,IAAI,uPAAkB;AAE7C,uCAAuC;AAEvC,2BAA2B;AAC3B,eAAe,QAAQ,CAAC,sDAAsD,qBAAqB;AACnG,eAAe,QAAQ,CAAC,kEAAkE,eAAe;AACzG,eAAe,QAAQ,CAAC,+DAA+D,gBAAgB;AAEvG,0BAA0B;AAC1B,eAAe,QAAQ,CAAC;AAExB,8BAA8B;AAC9B,eAAe,QAAQ,CAAC;AACxB,eAAe,QAAQ,CAAC;AAGxB,iDAAiD;AACjD,4EAA4E;AAC5E,eAAe,mBAAmB,CAAC;IACjC,QAAQ;AACV;AAEA,0CAA0C;AAC1C,IAAI;AACJ,wCAAmC;IACjC,IAAA,4PAAW,IAAG,IAAI,CAAC,CAAC;QAClB,IAAI,WAAW;YACb,YAAY,IAAA,6PAAY,EAAC;QAC3B;IACF;AACF"}},
    {"offset": {"line": 77, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/akash/PROJECTS/metaverse-lab-main/metaverse-lab-main/components/providers/AuthProvider.tsx"],"sourcesContent":["// // \"use client\";\n\n// // import React, { createContext, useContext, useEffect, useState } from \"react\";\n// // import { \n// //   User, \n// //   onAuthStateChanged, \n// //   signInWithPopup, \n// //   signOut \n// // } from \"firebase/auth\";\n// // import { auth, googleProvider } from \"@/lib/firebase\";\n\n// // // 1. Define the Context Shape (Including the login functions!)\n// // type AuthContextType = {\n// //   user: User | null;\n// //   loading: boolean;\n// //   signInWithGoogle: () => Promise<void>;\n// //   logout: () => Promise<void>;\n// // };\n\n// // // 2. Create Context with dummy defaults\n// // const AuthContext = createContext<AuthContextType>({\n// //   user: null,\n// //   loading: true,\n// //   signInWithGoogle: async () => {},\n// //   logout: async () => {},\n// // });\n\n// // export const useAuth = () => useContext(AuthContext);\n\n// // export default function AuthProvider({\n// //   children,\n// // }: {\n// //   children: React.ReactNode;\n// // }) {\n// //   const [user, setUser] = useState<User | null>(null);\n// //   const [loading, setLoading] = useState(true);\n\n// //   // 3. Define the Actions\n// //   const signInWithGoogle = async () => {\n// //     try {\n// //       await signInWithPopup(auth, googleProvider);\n// //     } catch (error) {\n// //       console.error(\"Login Failed:\", error);\n// //       alert(\"Login failed. Check console for details.\");\n// //     }\n// //   };\n\n// //   const logout = async () => {\n// //     try {\n// //       await signOut(auth);\n// //     } catch (error) {\n// //       console.error(\"Logout Failed:\", error);\n// //     }\n// //   };\n\n// //   // 4. Listen for Auth State Changes\n// //   useEffect(() => {\n// //     const unsubscribe = onAuthStateChanged(auth, (currentUser) => {\n// //       setUser(currentUser);\n// //       setLoading(false);\n// //     });\n// //     return () => unsubscribe();\n// //   }, []);\n\n// //   // 5. Expose everything\n// //   return (\n// //     <AuthContext.Provider value={{ user, loading, signInWithGoogle, logout }}>\n// //       {children}\n// //     </AuthContext.Provider>\n// //   );\n// // }\n\n// \"use client\";\n\n// import React, { createContext, useContext, useEffect, useState } from \"react\";\n// import { \n//   User, \n//   onAuthStateChanged, \n//   signInWithPopup, \n//   signOut,\n//   GoogleAuthProvider \n// } from \"firebase/auth\";\n// import { auth, googleProvider } from \"@/lib/firebase\";\n\n// // 1. Define Context including the Google Access Token\n// type AuthContextType = {\n//   user: User | null;\n//   googleToken: string | null;\n//   loading: boolean;\n//   signInWithGoogle: () => Promise<void>;\n//   logout: () => Promise<void>;\n// };\n\n// const AuthContext = createContext<AuthContextType>({\n//   user: null,\n//   googleToken: null,\n//   loading: true,\n//   signInWithGoogle: async () => {},\n//   logout: async () => {},\n// });\n\n// export const useAuth = () => useContext(AuthContext);\n\n// export default function AuthProvider({\n//   children,\n// }: {\n//   children: React.ReactNode;\n// }) {\n//   const [user, setUser] = useState<User | null>(null);\n//   const [googleToken, setGoogleToken] = useState<string | null>(null);\n//   const [loading, setLoading] = useState(true);\n\n//   const signInWithGoogle = async () => {\n//     try {\n//       // 2. REQUEST SCOPES (MVP: Ask for everything needed)\n//       // Classroom\n//       googleProvider.addScope('https://www.googleapis.com/auth/classroom.courses.readonly');\n//       googleProvider.addScope('https://www.googleapis.com/auth/classroom.coursework.me.readonly');\n//       googleProvider.addScope('https://www.googleapis.com/auth/classroom.announcements'); // For Teachers\n      \n//       // Calendar\n//       googleProvider.addScope('https://www.googleapis.com/auth/calendar.events.readonly');\n      \n//       // Sheets (Teacher Only - strictly managed by app logic, but scope needed)\n//       googleProvider.addScope('https://www.googleapis.com/auth/spreadsheets');\n\n//       const result = await signInWithPopup(auth, googleProvider);\n      \n//       // 3. CAPTURE ACCESS TOKEN\n//       // This is the key to accessing Google APIs directly from the client\n//       const credential = GoogleAuthProvider.credentialFromResult(result);\n//       if (credential?.accessToken) {\n//         setGoogleToken(credential.accessToken);\n//         // MVP Persistence: Save to local storage so it survives refresh (Not for Prod)\n//         localStorage.setItem(\"google_access_token\", credential.accessToken);\n//       }\n\n//     } catch (error) {\n//       console.error(\"Login Failed:\", error);\n//       alert(\"Login failed. Check console.\");\n//     }\n//   };\n\n//   const logout = async () => {\n//     try {\n//       await signOut(auth);\n//       setGoogleToken(null);\n//       localStorage.removeItem(\"google_access_token\");\n//     } catch (error) {\n//       console.error(\"Logout Failed:\", error);\n//     }\n//   };\n\n//   useEffect(() => {\n//     // Restore token from local storage if user is still logged in\n//     const storedToken = localStorage.getItem(\"google_access_token\");\n//     if (storedToken) setGoogleToken(storedToken);\n\n//     const unsubscribe = onAuthStateChanged(auth, (currentUser) => {\n//       setUser(currentUser);\n//       setLoading(false);\n//     });\n//     return () => unsubscribe();\n//   }, []);\n\n//   return (\n//     <AuthContext.Provider value={{ user, googleToken, loading, signInWithGoogle, logout }}>\n//       {children}\n//     </AuthContext.Provider>\n//   );\n// }\n\n\"use client\";\n\nimport React, { createContext, useContext, useEffect, useState } from \"react\";\nimport { \n  User, \n  onAuthStateChanged, \n  signInWithPopup, \n  signOut,\n  GoogleAuthProvider // Import this\n} from \"firebase/auth\";\nimport { auth, googleProvider } from \"@/lib/firebase\";\n\ntype AuthContextType = {\n  user: User | null;\n  loading: boolean;\n  accessToken: string | null; // Add this\n  signInWithGoogle: () => Promise<void>;\n  logout: () => Promise<void>;\n};\n\nconst AuthContext = createContext<AuthContextType>({\n  user: null,\n  loading: true,\n  accessToken: null,\n  signInWithGoogle: async () => {},\n  logout: async () => {},\n});\n\nexport const useAuth = () => useContext(AuthContext);\n\nexport default function AuthProvider({\n  children,\n}: {\n  children: React.ReactNode;\n}) {\n  const [user, setUser] = useState<User | null>(null);\n  const [accessToken, setAccessToken] = useState<string | null>(null); // State for token\n  const [loading, setLoading] = useState(true);\n\n  const signInWithGoogle = async () => {\n    try {\n      const result = await signInWithPopup(auth, googleProvider);\n      \n      // âœ… CAPTURE THE GOOGLE ACCESS TOKEN\n      const credential = GoogleAuthProvider.credentialFromResult(result);\n      const token = credential?.accessToken;\n      \n      if (token) {\n        setAccessToken(token);\n        // Store in session storage for persistence on refresh (secure enough for hackathons)\n        sessionStorage.setItem(\"google_access_token\", token);\n      }\n      \n    } catch (error) {\n      console.error(\"Login Failed:\", error);\n      alert(\"Login failed. Check console for details.\");\n    }\n  };\n\n  const logout = async () => {\n    try {\n      await signOut(auth);\n      setAccessToken(null);\n      sessionStorage.removeItem(\"google_access_token\");\n    } catch (error) {\n      console.error(\"Logout Failed:\", error);\n    }\n  };\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, (currentUser) => {\n      setUser(currentUser);\n      \n      // Attempt to recover token from session if user is logged in\n      const cachedToken = sessionStorage.getItem(\"google_access_token\");\n      if (cachedToken) setAccessToken(cachedToken);\n      \n      setLoading(false);\n    });\n    return () => unsubscribe();\n  }, []);\n\n  return (\n    <AuthContext.Provider value={{ user, loading, accessToken, signInWithGoogle, logout }}>\n      {children}\n    </AuthContext.Provider>\n  );\n}"],"names":[],"mappings":"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"}}]
}